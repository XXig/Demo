<!DOCTYPE HTML>
<html>
<head>
    <title>web</title>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="max-age=99999999999" />
    <meta http-equiv="Expires" content="Fri,15 Dec 2026 16:00:00 GMT">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="format-detection" content="telephone=no, email=no">
    <meta name="msapplication-tap-highlight" content="no">
    <script>
        document.documentElement.style.fontSize=window.screen.width/3.75 + 'px';
    </script>
    <style>
        body,html{width:100%;height:100%;-webkit-text-size-adjust:100%;-webkit-overflow-scrolling:touch;-webkit-touch-callout:none;-webkit-user-select:none;background-color:#f2f2f2}body{font:400 12px/1.5 "Microsoft YaHei",Helvetica,sans-serif;-webkit-font-smoothing:antialiased;overflow-x:hidden}*{box-sizing:border-box}li,ol,ul{list-style-type:none}b,h1,h2,h3,h4,h5,h6,strong{font-weight:500}b,body,button,dd,div,dl,dt,footer,form,h1,h2,h3,h4,h5,h6,header,html,img,input,li,nav,ol,p,pre,section,select,table,td,textarea,th,ul{margin:0;padding:0}a,body,button,img,input,label,select,textarea{outline:0 none;-webkit-tap-highlight-color:transparent}article,aside,figure,footer,header,nav,section{display:block}a{text-decoration:none;color:inherit;cursor:pointer;-webkit-touch-action:manipulation}a:focus,input:focus{-webkit-tap-highlight-color:transparent}a:visited{color:inherit}a,img{-webkit-touch-callout:none;-webkit-user-select:none;-webkit-user-drag:none}img{-ms-interpolation-mode:bicubic;height:auto;border:none}.img img,header img{pointer-events:none;display:block}.imgb img{display:block}.imgn img{pointer-events:none}.omg{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.fix:after,.fix:before{content:'';display:table;clear:both}.fix:after{clear:both}.xcenter{left:50%;-webkit-transform:translate3d(-50%,0,0);transform:translate3d(-50%,0,0)}.ycenter{top:50%;-webkit-transform:translate3d(0,-50%,0);transform:translate3d(0,-50%,0)}.xycenter{top:50%;left:50%;-webkit-transform:translate3d(-50%,-50%,0);transform:translate3d(-50%,-50%,0)}
        #wrap{
            position: fixed;
            bottom: 0;
            width: 100%;
            height: 100%;
        }
        #wrap>div:last-child{
        }
        .icon{
            z-index: 9999
        }
    </style>
    <script src="../css3d.min.js"></script>
</head>
<body>
    <div id="wrap">
        <div>其他</div>
    </div>
    <script type="text/javascript" src="../zepto.min.js"></script>
    <script>
        document.body.addEventListener("touchmove", function (a) {a.preventDefault()},!1);
        $(function(){
            $('.icon').on("click",function(){
                console.log($(this).attr("id"));
            })
            function i(t) {
                return .01 * parseInt(t, 10) + "rem"
            }
            window.addEventListener("deviceorientation",
                function(ev) {
                        var e = ev.gamma;a = ev.beta//手机上下翻,手机左右翻
                        if (e||a) {
                            $('#wrap>div:last-child').css("transform", "translate3d("+ i(.35 * e) + ",0,0)")
                        }
                    },true);
        })
    //创建场景
    var wrap = new C3D.Stage();
    wrap.size(window.innerWidth, window.innerHeight).update();
    document.getElementById('wrap').appendChild(wrap.el);

    //创建一个三维容器（创建以方便分组使用）
    var sp = new C3D.Sprite();
    sp.position(0, 0, -500).update();
    wrap.addChild(sp);

    var w=100,zd=w+50;

     // 小标签
     var front = new C3D.Plane();
     front.size(w).position(0, 0, zd).rotation(0, 0, 0).material({
        image: 'images/icon-bag.png'
    }).name('front').class('icon').id('cz').update();
     sp.addChild(front);

     var down = new C3D.Plane();
     down.size(w).position(0, zd, 0).rotation(-90, 0, 0).material({
        image: 'images/icon-bag.png'
    }).name('down').class('icon').id('hb').update();
     sp.addChild(down);

     var back = new C3D.Plane();
     back.size(w).position(0, 0, -zd).rotation(180, 0, 0).material({
        image: 'images/icon-bag.png'
    }).name('back').class('icon').id('wp').update();
     sp.addChild(back);

     var up = new C3D.Plane();
     up.size(w).position(0, -zd, 0).rotation(90, 0, 0).material({
        image: 'images/icon-bag.png'
    }).name('up').class('icon').id('zp').update();
     sp.addChild(up);

    //背景
    var bg = new C3D.Box(); 
    bg.size(300).origin(150, 150,150).rotation(0, 0, 0).material({ 
        front: {
            color:"#ff0"
        }, 
        down : {
            color:"#00f"
        }, 
        back : {
            color:"#fff"
        } , 
        up   : {
            color:"#f00"
        } 

    }).update();  
    sp.addChild(bg);  

    // 动作
    var isMoving = false;
    var lastMouseY = 0;
    var curMouseY = 0;
    var lastAngleY = 0;
    var angleY = 0;
    document.addEventListener("touchstart", touchstartHandler);
    document.addEventListener("touchend", touchendHandler);
    function touchstartHandler(evt) {
        lastMouseY = event.touches[0].pageY;
        lastAngleY = angleY;
        curMouseY = event.touches[0].pageY;
        document.addEventListener("touchmove", touchmoveHandler);
        requestAnimationFrame(go);
    }
    function touchmoveHandler(evt) {
        curMouseY = event.changedTouches[0].pageY;
    }
    function touchendHandler(evt) {
        curMouseY = event.changedTouches[0].pageY;
        document.removeEventListener("touchmove", touchmoveHandler);
    }

    //刷新场景
    function resize() {
        wrap.size(window.innerWidth, window.innerHeight).update();
    }
    window.onresize = function () {
        resize();
    };
    resize();

    requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame ||
    function (callback) {
        setTimeout(callback, 1000 / 60);
    };
    var d=90;
    function auto(){
        sp.rotate(0.2, 0, 0).updateT();
        d?(sp.rotationX<=d&&requestAnimationFrame(auto)):requestAnimationFrame(auto)
    }
    requestAnimationFrame(auto);
    function go() {
        d?(angleY += (curMouseY - lastMouseY + lastAngleY - angleY) * 0.3,angleY = Math.max(-d, Math.min(0, angleY))):angleY += (curMouseY - lastMouseY + lastAngleY - angleY) * 0.3;
        sp.rotation(-angleY, 0).updateT();
        requestAnimationFrame(go);
    }
</script>
</body>
</html>